# error_log stderr;
# events { worker_connections 1024; }

# http {
#   server {
#     listen 443 ssl;
#     server_name monica.example.com;
#     ssl_certificate /https-cert.pem;
#     ssl_certificate_key /https-key.pem;
#     ssl_protocols TLSv1.2;

#     location / {
#         proxy_pass http://monica:80;
#         proxy_set_header Host monica.example.com;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto https;
#     }
#   }
# }

# first go into sonarr settings, under "General" set the URL Base to /sonarr and restart the sonarr container
# to enable password access, uncomment the two auth_basic lines

location /monica {
#    auth_basic "Restricted";
#    auth_basic_user_file /config/nginx/.htpasswd;
    include /config/nginx/proxy.conf;
    resolver 127.0.0.11 valid=30s;
    set $upstream_monica monica;
    proxy_pass http://$upstream_monica:80;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
}